"use strict";(self["webpackChunkadmin"]=self["webpackChunkadmin"]||[]).push([[899],{9762:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-section"},[t("el-button",{staticClass:"add-user",attrs:{type:"primary"},on:{click:function(t){e.dialogAddFormVisible=!0}}},[e._v(" 添加用户 ")]),t("el-dialog",{attrs:{"modal-append-to-body":!1,title:"添加用户",visible:e.dialogAddFormVisible},on:{"update:visible":function(t){e.dialogAddFormVisible=t}}},[t("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.formRules}},[t("el-form-item",{attrs:{prop:"name",label:"姓名","label-width":e.formLabelWidth}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name","string"===typeof t?t.trim():t)},expression:"addForm.name"}})],1),t("el-form-item",{attrs:{prop:"phone",label:"电话","label-width":e.formLabelWidth}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"number"},model:{value:e.addForm.phone,callback:function(t){e.$set(e.addForm,"phone","string"===typeof t?t.trim():t)},expression:"addForm.phone"}})],1),t("el-form-item",{attrs:{prop:"password",label:"密码","label-width":e.formLabelWidth}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password","string"===typeof t?t.trim():t)},expression:"addForm.password"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogAddFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("addForm")}}},[e._v(" 确 定 ")])],1)],1),t("div",{staticClass:"user-search"},[t("el-input",{attrs:{size:"40px",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.usersFilter},slot:"append"},[e._v(" 搜索 ")])],1)],1),t("div",{staticClass:"user-list"},[[t("el-table",{attrs:{data:e.tableData,height:"80vh",border:""}},[t("el-table-column",{attrs:{prop:"id",label:"id",width:"100"}}),t("el-table-column",{attrs:{prop:"name",label:"姓名"}}),t("el-table-column",{attrs:{prop:"phone",label:"电话"}}),t("el-table-column",{attrs:{prop:"password",label:"密码"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{staticStyle:{"margin-right":"30px"},attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(t){return e.toEdit(r.row)}}},[e._v(" 编辑 ")]),t("el-dialog",{attrs:{"modal-append-to-body":!1,title:"编辑用户",visible:e.dialogEditFormVisible},on:{"update:visible":function(t){e.dialogEditFormVisible=t}}},[t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.formRules}},[t("el-form-item",{attrs:{prop:"name",label:"姓名","label-width":e.formLabelWidth}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name","string"===typeof t?t.trim():t)},expression:"editForm.name"}})],1),t("el-form-item",{attrs:{prop:"phone",label:"电话","label-width":e.formLabelWidth}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"number"},model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,"phone","string"===typeof t?t.trim():t)},expression:"editForm.phone"}})],1),t("el-form-item",{attrs:{prop:"password",label:"密码","label-width":e.formLabelWidth}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:e.editForm.password,callback:function(t){e.$set(e.editForm,"password","string"===typeof t?t.trim():t)},expression:"editForm.password"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogEditFormVisible=!1}}},[e._v(" 取 消 ")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("editForm")}}},[e._v(" 确 定 ")])],1)],1),t("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(t){return e.deleteRow(r.row.id)}}},[e._v(" 删除 ")])]}}])})],1)]],2)],1)},o=[],s=(r(1703),r(5764)),i={data(){const e=(e,t,r)=>{if(""!==t){if(t.length<6||t.length>16)return r(new Error("请输入6~16位密码")),!1;if(t.indexOf(" ")>-1)return r(new Error("请输入不包含空格的字符")),!1;if(!/^[^\u4e00-\u9fa5]*$/.test(t))return r(new Error("密码不能输入汉字")),!1;r()}};return{dialogAddFormVisible:!1,dialogEditFormVisible:!1,formLabelWidth:"130px",search:"",tableData:[],addForm:{name:"",phone:"",password:""},editForm:{name:"",phone:"",password:"",id:""},formRules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"目前只支持中国大陆的手机号码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:e,trigger:"blur"}]}}},created(){this.users()},watch:{search(){this.users()}},methods:{users(){s.Z.users().then((e=>{this.tableData=e}))},toEdit(e){this.editForm.id=e.id,this.editForm.name=e.name,this.editForm.phone=e.phone,this.editForm.password=e.password,this.dialogEditFormVisible=!0},submitForm(e){this.$refs[e].validate((t=>{if(t)if("editForm"==e){const e=this.editForm.id,t={...this.editForm};s.Z.updateUser(e,t).then((()=>{alert("编辑成功！"),this.dialogEditFormVisible=!1,this.users()}))}else if("addForm"==e){const e={...this.addForm};s.Z.addUser(e).then((()=>{alert("添加成功！"),this.dialogAddFormVisible=!1,this.addForm.name="",this.addForm.phone="",this.addForm.password="",this.users()}))}}))},usersFilter(){const e=this.search,t=this.tableData.filter((t=>{let r="";for(let e in t)"created_at"!=e&&"updated_at"!=e&&(r=r+t[e]+",");return r.includes(e)}));this.tableData=t},deleteRow(e){const t=confirm("删除后数据将不可恢复，请确认！");t&&(s.Z.deleteUser(e),this.users())}}},l=i,d=r(1001),n=(0,d.Z)(l,a,o,!1,null,"2018359e",null),m=n.exports},7962:function(e,t,r){var a=r(8499),o=r(6265),s=r.n(o);s().defaults.timeout=2e4,s().defaults.baseURL="/api",s().interceptors.request.use((e=>e),(e=>Promise.reject(e)));const i=e=>{const{response:t}=e,r=t?t.status:408;if(t){const{data:o}=t,{errors:s}=o,i=o.message||"服务器发送错误，请稍后再试";401===r?(console.log("没有登录"),localStorage.clear(),sessionStorage.clear(),window.location.reload(),console.log(e)):419===r?(console.log("页面过期"),localStorage.clear(),sessionStorage.clear(),window.location.reload()):422===r||423===r||429===r?Object.keys(s).forEach((e=>{const t=s[e].join("\n");a.Message.error(t)})):a.Message.error(i)}else a.Message.error("网络超时")};s().interceptors.response.use((e=>{switch(!0){case e.data&&200===e.data.code:return e.data.data;case e.data&&200!==e.data.code:return e.data.data?(a.Message.error(e.data.data),Promise.reject(e.data.data)):(a.Message.error(e.data),Promise.reject(e.data));default:return e.data}}),(e=>(i(e),Promise.reject(e)))),t["Z"]={post(e="",t={},r={}){return s().post(e,t,r)},put(e="",t={},r={}){return s().put(e,t,r)},get(e="",t={},r={}){const a=Object.assign({params:t},r);return s().get(e,a)},delete(e="",t={},r={}){const a=Object.assign({params:t},r);return s()["delete"](e,a)}}},5764:function(e,t,r){var a=r(7962);const o={login(e){return a.Z.post("/login",e).then((e=>e))},users(){return a.Z.get("/user").then((e=>e))},addUser(e){return a.Z.post("/user",e).then((e=>e))},updateUser(e,t){return a.Z.put("/user/"+e,t).then((e=>e))},deleteUser(e){return a.Z["delete"]("/user/"+e).then((e=>e))}};t["Z"]=o}}]);
//# sourceMappingURL=theuser.aa3de90b.js.map